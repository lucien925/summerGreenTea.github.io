<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javascript工具库-lodash.js · 淡夏的绿茶</title><meta name="description" content="javascript工具库-lodash.js - summer"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/summerGreenTea" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">javascript工具库-lodash.js</h1><div class="post-info">Dec 25, 2015</div><div class="post-content"><p>如果你曾经使用过<strong>underscore</strong>,那么你一定会喜欢今天我要介绍的<strong>lodash</strong>。<br><a id="more"></a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p><strong>lodash</strong>起初是由<strong>underscore</strong>演变而来的。因为与underscore的其他贡献者意见相斥，于是乎lodash的开发者就更具自己的理解，开发出lodash这个javascript工具库。</p>
<p>于underscore一样，lodash也沿用了 _ 作为全局访问对象来对工具库函数api的快速访问。</p>
<p>最新版的lodash是4.0版本，比较重要的改变是这个版本也是不再对IE6-8的支持，相关的信息可以<a href="https://github.com/lodash/lodash/wiki/Changelog" target="_blank" rel="external">点击查看</a>.</p>
<h2 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h2><p>想对比与underscore，lodash的带给我的惊喜可不止是一点点。</p>
<h3 id="API文档"><a href="#API文档" class="headerlink" title="API文档"></a>API文档</h3><p>早些时候，当我发现lodash这个工具库的之前，我还是一直使用underscore作为必备首选。但是当我查看了lodash的文档和官方介绍后，毅然的决定抛弃underscore。</p>
<p>单方面的个人感受，当我查看相关api文档时，lodash的文档着实详细易看。参数的类型描述、返回结果的类型和给的示例都非常详细，对比与我这个写代码几乎不写注释的人来说，结结实实的打脸啊。</p>
<h3 id="延迟计算"><a href="#延迟计算" class="headerlink" title="延迟计算"></a>延迟计算</h3><p>lodash的执行效率则是最受好评的一个点。lodash的作者也提到了，lodash的最初目标是提供更多的”一致的跨浏览器的行为，并改善性能”。lodash采用的延迟计算的策略，具体是怎么个实现方式呢，我们俩看一段代码:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function priceLt(x) &#123;</div><div class="line">   <span class="keyword">return</span> function(item) &#123; <span class="keyword">return</span> item.price &lt; x; &#125;;</div><div class="line">&#125;</div><div class="line">var gems = [</div><div class="line">   &#123; <span class="string">name:</span> <span class="string">'Sunstone'</span>, <span class="string">price:</span> <span class="number">4</span> &#125;, &#123; <span class="string">name:</span> <span class="string">'Amethyst'</span>, <span class="string">price:</span> <span class="number">15</span> &#125;,</div><div class="line">   &#123; <span class="string">name:</span> <span class="string">'Prehnite'</span>, <span class="string">price:</span> <span class="number">20</span>&#125;, &#123; <span class="string">name:</span> <span class="string">'Sugilite'</span>, <span class="string">price:</span> <span class="number">7</span>  &#125;,</div><div class="line">   &#123; <span class="string">name:</span> <span class="string">'Diopside'</span>, <span class="string">price:</span> <span class="number">3</span> &#125;, &#123; <span class="string">name:</span> <span class="string">'Feldspar'</span>, <span class="string">price:</span> <span class="number">13</span> &#125;,</div><div class="line">   &#123; <span class="string">name:</span> <span class="string">'Dioptase'</span>, <span class="string">price:</span> <span class="number">2</span> &#125;, &#123; <span class="string">name:</span> <span class="string">'Sapphire'</span>, <span class="string">price:</span> <span class="number">20</span> &#125;</div><div class="line">];</div><div class="line"></div><div class="line">var chosen = _(gems).filter(priceLt(<span class="number">10</span>)).take(<span class="number">3</span>).value();</div></pre></td></tr></table></figure>
<p>它的运行示意图是:<br><img src="/2015/12/25/lodash/lodash-naive.gif" alt="lodash-naive.gif" title=""></p>
<p>上面一共读取了8个元素，然后我们取出我们需要的3个元素。不难发现，其实我们只需要读取前5个元素，就能找到我们想要的那3个结果。那么它原本应该的结果应该是:</p>
<img src="/2015/12/25/lodash/grafika.gif" alt="grafika.gif" title="">
<p>那么延迟计算的特点在于，它将我们在链式执行筛选函数的条件都延迟到最后一个筛选条件一并执行(这些筛选条件必须连续)，这个有点类似于浏览器对repaint/reflow的优化所干的事。<br>上面代码用伪代码就可以近似表示为:</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">var</span> takeNum = <span class="number">3</span>, result = [];</div><div class="line"><span class="keyword">for</span>(<span class="built_in">var</span> i = <span class="number">0</span>, len = gems.<span class="built_in">length</span>; i &lt; len; i++) &#123;</div><div class="line">	<span class="keyword">if</span>(priceLt(gems[i])) &#123;</div><div class="line">		reuslt.<span class="built_in">push</span>(gems[i]);</div><div class="line">		<span class="keyword">if</span>(reuslt.<span class="built_in">length</span> == <span class="number">3</span>) &#123;</div><div class="line">			<span class="built_in">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>关于lodash延迟计算的一些讲解，我觉得<a href="http://filimanjaro.com/blog/2014/introducing-lazy-evaluation/" target="_blank" rel="external">How to Speed Up Lo-Dash ×100? Introducing Lazy Evaluation.</a>这篇文章讲的很有意识，作者的语言和理解比较易懂。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>其实也可以挑一些有特点的api来适当的说明下lodash的api上的特点，但是个人觉得再怎么将还不如翻一翻官方文档，之前也说到了lodash的官方文档带给我的感受了。<br>在知乎上，很多大牛都觉的underscore的源码很是值得一读和重新实现，但现在觉得lodash的源码更是值得细细专研下(未压缩版的lodash源码的注释意识十分详细)。代码规范、如何实现延迟计算、函数式编程的思想，学以致用的最高境界也当要学透。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/12/28/css3-animation/" class="prev">上一篇</a><a href="/2015/12/25/javascript-this/" class="next">下一篇</a></div><div data-thread-key="2015/12/25/lodash/" data-title="javascript工具库-lodash.js" data-url="http://summerGreenTea.github.io/2015/12/25/lodash/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"yuhuan"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://summerGreenTea.github.io">summer</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>